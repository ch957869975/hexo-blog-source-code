---
title: 【前端基础】逻辑运算符
date: 2019-12-25 10:00:00
tags:
  - 前端基础
---

JavaScript 里有三个逻辑运算符：`||`（或），`&&`（与），`!`（非）。
非运算符 `!`的优先级在所有逻辑运算符里面最高，所以它总是在 `&&` 和 `||` 前执行。

<!--more-->

## || 或

两个管道符表示“或”运算

```js
alert(true || true); // true
alert(false || true); // true
alert(true || false); // true
alert(false || false); // false
```

除了两个操作数都是 false 的情况，结果都是 true，如果操作数不是布尔值，那么它将会被转化为布尔值来参与运算。

大多数情况 `||` 会被用在 `if` 语句中，用来测试任何给定的条件是否为 true

```js
if (age > 18 || age < 10) {
  // do something
}
```

### || 寻找第一个真值

```js
result = val1 || val2 || val3;
```

`||` 运算符做了如下事情

- 从左到右依次计算操作数
- 处理每一个操作数时，都将其转化为布尔值。如果结果是 true，就停止计算，返回这个操作数的初始值
- 如果所有的操作数都被计算过（也就是，转换结果都是 false），则返回**最后一个操作数**

返回的值是操作数的初始形式，不会做布尔转换。也就是，一个或 "||" 运算的链，将返回第一个真值，如果不存在真值，就返回该链的最后一个值。比如：

```js
alert(1 || 0); // 1（1 是真值）
alert(true || "no matter what"); //（true 是真值）

alert(null || 1); // 1（1 是第一个真值）
alert(null || 0 || 1); // 1（第一个真值）
alert(undefined || null || 0); // 0（所有的转化结果都是 false，返回最后一个值）
```

就这样，引申出了一些有趣的用法

### 1. 获取变量列表或者表达式的第一个真值

假设我们有几个变量，它们可能包含某些数据或者是 null/undefined。我们需要选出第一个包含数据的变量。我们可以这样应用或运算 ||：

```js
let currentUser = null;
let defaultUser = "John";

let name = currentUser || defaultUser || "unnamed";

alert(name); // 选出了 “John” — 第一个真值
```

如果 currentUser 和 defaultUser 都是假值，那么结果就是 "unnamed"。

### 2. 短路取值

操作数不仅仅可以是值，还可以是任意表达式。或运算会从左到右计算并测试每个操作数。当找到第一个真值，计算就会停止，并返回这个值。这个过程就叫做“短路取值”，因为它尽可能地减少从左到右计算的次数。

当表达式作为第二个参数并且有一定的副作用（side effects），比如变量赋值的时候，短路取值的情况就清楚可见。

如果我们运行下面的例子，x 将不会被赋值：

```js
let x;
true || (x = 1);
alert(x); // undefined，因为 (x = 1) 没有被执行
```

如果第一个参数是 false，或运算将会继续，并计算第二个参数，也就会运行赋值操作。

```js
let x;
false || (x = 1);
alert(x); // 1
```

大多数情况下，最好使用“常规的” if 语句，这样代码可读性更高，但是有时候这种方式会很简洁。

## && 与

```js
result = a && b;
alert(true && true); // true
alert(false && true); // false
alert(true && false); // false
alert(false && false); // false
```

`if` 语句中 的使用

```js
let sex = "male";
let age = 18;
if (age === 18 && sex === "male") {
  alert("你是一个18岁的男孩子");
}
```

### && 寻找第一个假值

给出多个参与运算的值：

```js
result = value1 && value2 && value3;
```

与运算 `&&` 做了如下的事：

- 从左到右依次计算操作数
- 将处理每一个操作数时，都将其转化为布尔值。如果结果是 false，就停止计算，并返回这个操作数的初始值。
- 如果所有的操作数都被计算过（也就是，转换结果都是 true），则返回 **最后一个操作数**。

**换句话说，与操作符返回第一个假值，如果没有假值就返回最后一个值。**

> 与运算 `&&` 在或操作符 `||`之前执行。与运算 `&&` 的优先级比或运算 `||` 要高。
> 所以代码 `a && b || c && d`完全跟 && 表达式加了括号一样：`(a && b) || (c && d)`。

### 短路取值

```js
let x = 1;

x > 0 && alert("Greater than zero!");
```

右边的代码只有运算抵达到那里才能被执行。也就是，当且仅当 (x > 0) 返回了真值。所以我们基本可以类似地得到：

```js
let x = 1;

if (x > 0) {
  alert("Greater than zero!");
}
```

带 `&&` 的代码变体看上去更短。但是 `if` 的含义更明显，可读性也更高。所以建议是根据目的选择代码的结构。需要条件判断就用 `if`，需要与运算就用 `&&`

## ! 非

> 非运算符 `!` 的优先级在所有逻辑运算符里面最高，所以它总是在 `&&` 和 `||` 前执行。

非 没什么好讲的。两个非运算 `!!` 有时候用来将某个值转化为布尔类型

```js
alert(!!"non-empty string"); // true
alert(!!null); // false
```

也就是，第一个非运算将该值转化为布尔类型并取反，第二个非运算再次取反。最后我们就得到了一个任意值到布尔值的转化。
